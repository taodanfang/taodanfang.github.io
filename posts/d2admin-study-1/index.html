<!DOCTYPE html>
<html lang="" dir="ltr">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>基于D2admin定制化微服务前端应用的开发方法 &middot; CC-Table： 专注协同计算技术研发</title>
  <meta name="description" content="" />
  <link href="https://taodanfang.github.io/css/katex.css" rel="stylesheet">
  
  
  
  
  <link href="https://taodanfang.github.io/css/concated.min.css" rel="stylesheet">
  
  


</head>


  <body > 
    <div style="position: fixed; z-index: 500;
    width: 100vw; background-color: black; color: white;
    box-shadow: 0 0.4rem 2rem 0 rgba(0,0,0,0.2);">
        
<nav class="nav-bar side-padding" style="max-width: 100vw;"
>
  <h1 class="nav-header"><a href="https://taodanfang.github.io" 
    class="nav-text" style="color: wheat;">熙熙表格</a></h1>
 
  <h3 class="nav-header nav-text" 
  >
  <a href="#single-page-head" style="font-size: 18px; color:lightgreen; padding-top: 4px;">  基于D2admin定制化微服务前端应用的开发方法</a>

</h3>
  
  <div class="hamburger-menu">
    <button onclick="hamburgerMenuPressed.call(this)" aria-haspopup="true" aria-expanded="false" aria-controls="menu" aria-label="Menu">
      <span  style="background-color: wheat;"></span>
      <span  style="background-color: wheat;"></span>
    </button>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="https://taodanfang.github.io" class="hamburger-menu-overlay-link">Home</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/bleve/" class="hamburger-menu-overlay-link">bleve</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/boltdb/" class="hamburger-menu-overlay-link">boltdb</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/casbin/" class="hamburger-menu-overlay-link">casbin</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/cc-table/" class="hamburger-menu-overlay-link">cc-table</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/channel/" class="hamburger-menu-overlay-link">channel</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/context/" class="hamburger-menu-overlay-link">context</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/crdt/" class="hamburger-menu-overlay-link">CRDT</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/d2admin/" class="hamburger-menu-overlay-link">d2admin</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/deployment/" class="hamburger-menu-overlay-link">deployment</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/distributed-computing/" class="hamburger-menu-overlay-link">distributed computing</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/drag-and-drop/" class="hamburger-menu-overlay-link">drag and drop</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/event/" class="hamburger-menu-overlay-link">event</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/go/" class="hamburger-menu-overlay-link">go</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/golang/" class="hamburger-menu-overlay-link">golang</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/goroutine/" class="hamburger-menu-overlay-link">goroutine</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/iot/" class="hamburger-menu-overlay-link">iot</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/kit/" class="hamburger-menu-overlay-link">kit</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/math/" class="hamburger-menu-overlay-link">math</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/microservice/" class="hamburger-menu-overlay-link">microservice</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/mongodb/" class="hamburger-menu-overlay-link">mongodb</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/nats/" class="hamburger-menu-overlay-link">nats</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/page/" class="hamburger-menu-overlay-link">page</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/practice/" class="hamburger-menu-overlay-link">practice</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/pubsub/" class="hamburger-menu-overlay-link">pubsub</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/rule/" class="hamburger-menu-overlay-link">rule</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/schedule/" class="hamburger-menu-overlay-link">“schedule&#34;</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/search/" class="hamburger-menu-overlay-link">search</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/socket.io/" class="hamburger-menu-overlay-link">socket.io</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/task/" class="hamburger-menu-overlay-link">task</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/tenant/" class="hamburger-menu-overlay-link">tenant</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/tree/" class="hamburger-menu-overlay-link">tree</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/vue/" class="hamburger-menu-overlay-link">vue</a></li>
      
      <li><a href="https://taodanfang.github.io/categories/websocket/" class="hamburger-menu-overlay-link">websocket</a></li>
      
      
    </ul>
  </div>
</nav>



    </div>

    <div class="single-body">
      <main id="single-page-head" class="content side-text-padding" style="margin-top: 108px;">
        <article class="post dropcase">
          <header class="post-header">

            <h1 class="post-title" >基于D2admin定制化微服务前端应用的开发方法</h1>
            
            <div class="nav-bar">
              <p class="post-date">
                Posted 
                <time datetime="2021-07-12">Jul 12, 2021</time>
              </p>

              <div>
                <span style="font-size: 14px; padding-top: 0px;;"
                 id="busuanzi_container_site_uv">
                本站访客数
                <span style="padding-left: 4px; padding-right: 4px; color: red;"
                id="busuanzi_value_site_uv"></span> 人次, 
                </span>
                <span style="font-size: 14px; padding-bottom: 10px;;"
                id="busuanzi_container_page_pv">
                    本文总阅读量
                    <span style="padding-left: 4px; padding-right: 4px; color: red;"  
                    id="busuanzi_value_page_pv"></span> 次
                </span>
              </div>
            </div>
            
            

          </header>
          <picture class="post-figure">
            
            
            
            <source srcset="https://taodanfang.github.io/posts/d2admin-study-1/image-3_huc44826355b0dcfe6db5d93780f7f411f_3185427_711x0_resize_q75_lanczos.jpeg 1x, https://taodanfang.github.io/posts/d2admin-study-1/image-3_huc44826355b0dcfe6db5d93780f7f411f_3185427_1422x0_resize_q75_lanczos.jpeg 2x, https://taodanfang.github.io/posts/d2admin-study-1/image-3_huc44826355b0dcfe6db5d93780f7f411f_3185427_2133x0_resize_q75_lanczos.jpeg 3x">
            <img src="https://taodanfang.github.io/posts/d2admin-study-1/image-3_huc44826355b0dcfe6db5d93780f7f411f_3185427_711x0_resize_q75_lanczos.jpeg" >
          </picture>
          


          <div class="content-toc" style="min-width: 280px;" >
            <div style="margin-top: -20px;">
              <h2 style="margin-top: 10px;">目录</h2>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#一框架部署">一，框架部署</a></li>
    <li><a href="#二框架配置">二，框架配置</a></li>
    <li><a href="#三框架调整">三，框架调整</a></li>
    <li><a href="#四tailwind">四，Tailwind</a></li>
    <li><a href="#五图表插件">五，图表插件</a></li>
    <li><a href="#六表格插件">六，表格插件</a></li>
    <li><a href="#七数据管理">七，数据管理</a></li>
    <li><a href="#八认证管理">八，认证管理</a></li>
    <li><a href="#九微服务项目结构">九，微服务项目结构</a></li>
    <li><a href="#参考文献">参考文献</a></li>
  </ul>
</nav>
            </div>
          </div>

          <div class="next-post"  style="min-width: 250px;" >
            
            <a ontouchstart="cardPressed.call(this)" ontouchend="cardReleased.call(this)" ontouchmove="cardReleased.call(this)" 
  href="https://taodanfang.github.io/posts/go-kit-example-study-1/" class="card blog-card bc-next" rel="bookmark" >

  <article class="card-body">
    <h2 class="card-title">Go Kit 官方示例学习及其 API Gateway 实现</h2>
    <p class="card-text">该文是Go kit 官方示例的学习笔记，并总结了结合stringsvc实现 API Gateway 的方法
</p>
    <div class="card-subtext muted-text">
      <p>Posted <time datetime="2021-07-07 77:00">Jul 7, 2021</time></p>
      <p>#golang #kit #microservice </p>
    </div>
  </article>
</a>
            
          </div>

          <p><a href="https://github.com/d2-projects/d2-admin">D2Admin </a>是一个完全 <strong>开源免费</strong> 的企业中后台产品前端集成方案，使用最新的前端技术栈，小于 60kb 的本地首屏 js 加载，已经做好大部分项目前期准备工作，并且带有大量示例代码，助力管理系统快速开发。本文介绍基于D2admin框架进行微服务前端开发的基本思路和过程。</p>
<p>效果图：</p>
<p><img src="image-20210725152932423.png" alt="image-20210725152932423"></p>
<h2 id="一框架部署">一，框架部署</h2>
<blockquote>
<p>建议是使用 <strong>简化版起始模板</strong> 因为在完整版的基础上做减法，要比在简化版基础上做加法复杂</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#008000">cd</span> web
git clone https://github.com/d2-projects/d2-admin-start-kit.git
<span style="color:#408080;font-style:italic"># or </span>
wget https://github.com/d2-projects/d2-admin-start-kit/archive/refs/heads/master.zip

unzip d2-admin-start-kit-master.zip
mv d2-admin-start-kit-master cctable
<span style="color:#008000">cd</span> cctable

<span style="color:#408080;font-style:italic"># 安装依赖</span>
npm install
<span style="color:#408080;font-style:italic"># 启动</span>
npm start
</code></pre></div><blockquote>
<p>D2-admin 版本号：1.20.1（2021.5.22）</p>
</blockquote>
<h2 id="二框架配置">二，框架配置</h2>
<blockquote>
<p>安装必要插件</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#008000;font-weight:bold">&#34;bootstrap-vue&#34;</span>: <span style="color:#ba2121">&#34;^2.21.2&#34;</span>,
    <span style="color:#008000;font-weight:bold">&#34;element-ui&#34;</span>: <span style="color:#ba2121">&#34;^2.15.1&#34;</span>,

    <span style="color:#008000;font-weight:bold">&#34;vxe-table&#34;</span>: <span style="color:#ba2121">&#34;^3.2.9&#34;</span>,
    <span style="color:#008000;font-weight:bold">&#34;xe-utils&#34;</span>: <span style="color:#ba2121">&#34;^3.1.13&#34;</span>,
  }
</code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#008000">cd</span> cctable
npm install --save bootstrap-vue
npm install --save element-ui
npm install --save xe-utils vxe-table
</code></pre></div><blockquote>
<p>启用插件（main.js）</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// Vue
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">import</span> Vue from <span style="color:#ba2121">&#39;vue&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> i18n from <span style="color:#ba2121">&#39;./i18n&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> App from <span style="color:#ba2121">&#39;./App&#39;</span>

<span style="color:#408080;font-style:italic">// 第三方插件
</span><span style="color:#408080;font-style:italic">// ------------------------------------------------
</span><span style="color:#408080;font-style:italic"></span>
<span style="color:#008000;font-weight:bold">import</span> ElementUI from <span style="color:#ba2121">&#39;element-ui&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#ba2121">&#39;element-ui/lib/theme-chalk/index.css&#39;</span>

<span style="color:#008000;font-weight:bold">import</span> { BootstrapVue, BootstrapVueIcons } from <span style="color:#ba2121">&#39;bootstrap-vue&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#ba2121">&#39;bootstrap/dist/css/bootstrap.css&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#ba2121">&#39;bootstrap-vue/dist/bootstrap-vue.css&#39;</span>

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#ba2121">&#39;xe-utils&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> VXETable from <span style="color:#ba2121">&#39;vxe-table&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#ba2121">&#39;vxe-table/lib/style.css&#39;</span>

<span style="color:#408080;font-style:italic">// ------------------------------------------------
</span><span style="color:#408080;font-style:italic"></span>
....

<span style="color:#408080;font-style:italic">// 第三方插件
</span><span style="color:#408080;font-style:italic">// ------------------------------------------------
</span><span style="color:#408080;font-style:italic"></span>Vue.use(ElementUI)
Vue.use(BootstrapVue)
Vue.use(BootstrapVueIcons)
Vue.use(VXETable)

Vue.prototype.$XModal <span style="color:#666">=</span> VXETable.modal
<span style="color:#408080;font-style:italic">// ------------------------------------------------
</span><span style="color:#408080;font-style:italic"></span>
</code></pre></div><blockquote>
<p>安装Tailwind</p>
<p><a href="https://cloud.tencent.com/developer/article/1557489">https://cloud.tencent.com/developer/article/1557489</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#008000">cd</span> cctable
npm install tailwindcss
touch src/assets/css/tailwind.css
<span style="color:#408080;font-style:italic">## 添加如下内容</span>
@tailwind base;
@tailwind components;
@tailwind utilities;

<span style="color:#408080;font-style:italic"># 在main.js 中加入</span>
import <span style="color:#ba2121">&#39;@/assets/css/tailwind.css&#39;</span>

npx tailwind init -p
touch postcss.config.js
<span style="color:#408080;font-style:italic"># 加入如下内容</span>
const <span style="color:#19177c">purgecss</span> <span style="color:#666">=</span> require<span style="color:#666">(</span><span style="color:#ba2121">&#39;@fullhuman/postcss-purgecss&#39;</span><span style="color:#666">)({</span>
    content: <span style="color:#666">[</span>
      <span style="color:#ba2121">&#39;./src/**/*.html&#39;</span>,
      <span style="color:#ba2121">&#39;./src/**/*.vue&#39;</span>,
      <span style="color:#ba2121">&#39;./src/**/*.jsx&#39;</span>,
    <span style="color:#666">]</span>,

    // Include any special characters you<span style="color:#ba2121">&#39;re using in this regular expression
</span><span style="color:#ba2121">    defaultExtractor: content =&gt; content.match(/[\w-/:]+(?&lt;!:)/g) || []
</span><span style="color:#ba2121">  })
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">module.exports = {
</span><span style="color:#ba2121">    plugins: [
</span><span style="color:#ba2121">      require(&#39;</span>tailwindcss<span style="color:#ba2121">&#39;),
</span><span style="color:#ba2121">      require(&#39;</span>autoprefixer<span style="color:#ba2121">&#39;),
</span><span style="color:#ba2121">      ...process.env.NODE_ENV === &#39;</span>production<span style="">&#39;</span>
      ? <span style="color:#666">[</span>purgecss<span style="color:#666">]</span>
      : <span style="color:#666">[]</span>
    <span style="color:#666">]</span>
  <span style="color:#666">}</span>
  
mv .postcssrc.js .postcssrc.js.old

<span style="color:#408080;font-style:italic">## 解决 PostCSS 8 不兼容问题</span>
npm uninstall tailwindcss postcss autoprefixer
npm install -D tailwindcss@npm:@tailwindcss/postcss7-compat @tailwindcss/postcss7-compat postcss@^7 autoprefixer@^9

<span style="color:#408080;font-style:italic"># 重新编译并启动</span>
npm install
npm start
</code></pre></div><h2 id="三框架调整">三，框架调整</h2>
<blockquote>
<p>Title, logo</p>
</blockquote>
<ul>
<li>.env</li>
<li>.env.development</li>
</ul>
<blockquote>
<p>Theme</p>
</blockquote>
<ul>
<li><input disabled="" type="checkbox"> src/assets/style/theme/theme-base.scss</li>
</ul>
<blockquote>
<p>layout</p>
</blockquote>
<ul>
<li><input disabled="" type="checkbox"> src/layout/header-aside/layout.vue</li>
</ul>
<blockquote>
<p>demo</p>
</blockquote>
<ul>
<li><input disabled="" type="checkbox"> src/views/demo</li>
</ul>
<blockquote>
<p>UI 设计思路：</p>
</blockquote>
<ul>
<li>采用模块化和定制化相结合的设计思路
<ul>
<li>模块化：elementui/bootstrapvue</li>
<li>定制化：tailwindcss</li>
</ul>
</li>
<li>UI设计风格
<ul>
<li>管理系统导航与社交化导航相结合（左边栏）</li>
<li>管理系统UI（表格驱动）
<ul>
<li>操作（右边栏）</li>
</ul>
</li>
<li>协作系统UI（内容驱动）
<ul>
<li>单人协作（弹框、右边栏、页内）</li>
<li>多人协作（表格、列表、看板等）</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="四tailwind">四，Tailwind</h2>
<blockquote>
<p>重要事项：</p>
</blockquote>
<ul>
<li>默认以APP模式进行UI设计，即移动端端点优先，然后依次设计各个端点相关的UI布局</li>
</ul>
<h2 id="五图表插件">五，图表插件</h2>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">npm install --save v-charts echarts@4.9.0

<span style="color:#408080;font-style:italic">## main.js</span>
import VCharts from <span style="color:#ba2121">&#39;v-charts&#39;</span>
Vue.use<span style="color:#666">(</span>VCharts<span style="color:#666">)</span>
</code></pre></div><h2 id="六表格插件">六，表格插件</h2>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">npm install --save @d2-projects/d2-crud

<span style="color:#408080;font-style:italic">## main.js</span>
import D2Crud from <span style="color:#ba2121">&#39;@d2-projects/d2-crud&#39;</span>
Vue.use<span style="color:#666">(</span>D2Crud<span style="color:#666">)</span>
</code></pre></div><h2 id="七数据管理">七，数据管理</h2>
<blockquote>
<p>基本思路：</p>
<ul>
<li>采用MAVP模式进行开发
<ul>
<li>Mock （模拟后端服务器，设计后端数据库和API）</li>
<li>Api （封装axios调用后端API，测试时封装MOCK，后续可以替换为真实后端Server）</li>
<li>Vuex （使用vuex缓存数据，调用API获取后端数据，Vuex相当于前端数据库）</li>
<li>Page（前端页面，调用vuex缓存接口对数据进行展示和处理）</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<p>安装mockjs</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">npm install --save mockjs
</code></pre></div><blockquote>
<p>response.payload 的标准化处理（通信协议）</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/mock/result.js
</span><span style="color:#408080;font-style:italic"></span>
<span style="color:#008000;font-weight:bold">const</span> Ok <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">function</span>(data, msg) {
  <span style="color:#008000;font-weight:bold">let</span> the_msg <span style="color:#666">=</span> <span style="color:#ba2121">&#39;ok&#39;</span>
  <span style="color:#008000;font-weight:bold">if</span> (msg) {
    <span style="color:#008000;font-weight:bold">if</span> (msg <span style="color:#666">!==</span> <span style="color:#ba2121">&#39;&#39;</span>) {
      the_msg <span style="color:#666">=</span> msg
    }
  }

  <span style="color:#008000;font-weight:bold">let</span> the_data <span style="color:#666">=</span> {}
  <span style="color:#008000;font-weight:bold">if</span> (data) {
    the_data <span style="color:#666">=</span> data
  }

  <span style="color:#008000;font-weight:bold">let</span> a_result <span style="color:#666">=</span> {
    success<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span>,
    code<span style="color:#666">:</span> <span style="color:#ba2121">&#39;server-api-ok&#39;</span>,
    error<span style="color:#666">:</span> {},
    response<span style="color:#666">:</span> {
      data<span style="color:#666">:</span> the_data,
      msg<span style="color:#666">:</span> the_msg,
      expired<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">false</span>,
    }
  }
  <span style="color:#008000;font-weight:bold">return</span> a_result
}

<span style="color:#008000;font-weight:bold">const</span> <span style="color:#008000">Error</span> <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">function</span>(msg, data) {
  <span style="color:#008000;font-weight:bold">let</span> the_msg <span style="color:#666">=</span> <span style="color:#ba2121">&#39;error&#39;</span>
  <span style="color:#008000;font-weight:bold">if</span> (msg) {
    <span style="color:#008000;font-weight:bold">if</span> (msg <span style="color:#666">!==</span> <span style="color:#ba2121">&#39;&#39;</span>) {
      the_msg <span style="color:#666">=</span> msg
    }
  }

  <span style="color:#008000;font-weight:bold">let</span> the_data <span style="color:#666">=</span> {}
  <span style="color:#008000;font-weight:bold">if</span> (data) {
    the_data <span style="color:#666">=</span> data
  }

  <span style="color:#008000;font-weight:bold">let</span> a_result <span style="color:#666">=</span> {
    success<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">false</span>,
    code<span style="color:#666">:</span> <span style="color:#ba2121">&#39;server-api-error&#39;</span>,
    response<span style="color:#666">:</span> {},
    error<span style="color:#666">:</span> {
      data<span style="color:#666">:</span> the_data,
      msg<span style="color:#666">:</span> the_msg,
      expired<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">false</span>,
    }
  }
  <span style="color:#008000;font-weight:bold">return</span> a_result
}

<span style="color:#008000;font-weight:bold">export</span> <span style="color:#008000;font-weight:bold">default</span> {
  Ok, <span style="color:#008000">Error</span>
}

</code></pre></div><blockquote>
<p>引入 axios 拦截插件</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/plugin/axios/index.js
</span><span style="color:#408080;font-style:italic"></span>
<span style="color:#008000;font-weight:bold">import</span> store from <span style="color:#ba2121">&#39;@/store&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> axios from <span style="color:#ba2121">&#39;axios&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> { Message } from <span style="color:#ba2121">&#39;element-ui&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> util from <span style="color:#ba2121">&#39;@/libs/util&#39;</span>

<span style="color:#408080;font-style:italic">// 创建一个错误
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">function</span> errorCreate (msg) {
  <span style="color:#008000;font-weight:bold">const</span> error <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">new</span> <span style="color:#008000">Error</span>(msg)
  errorLog(error)
  <span style="color:#008000;font-weight:bold">throw</span> error
}

<span style="color:#408080;font-style:italic">// 记录和显示错误
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">function</span> errorLog (error) {
  <span style="color:#408080;font-style:italic">// 添加到日志
</span><span style="color:#408080;font-style:italic"></span>  store.dispatch(<span style="color:#ba2121">&#39;d2admin/log/push&#39;</span>, {
    message<span style="color:#666">:</span> <span style="color:#ba2121">&#39;数据请求异常&#39;</span>,
    type<span style="color:#666">:</span> <span style="color:#ba2121">&#39;danger&#39;</span>,
    meta<span style="color:#666">:</span> {
      error
    }
  })
  <span style="color:#408080;font-style:italic">// 打印到控制台
</span><span style="color:#408080;font-style:italic"></span>  <span style="color:#008000;font-weight:bold">if</span> (process.env.NODE_ENV <span style="color:#666">===</span> <span style="color:#ba2121">&#39;development&#39;</span>) {
    util.log.danger(<span style="color:#ba2121">&#39;&gt;&gt;&gt;&gt;&gt;&gt; Error &gt;&gt;&gt;&gt;&gt;&gt;&#39;</span>)
    console.log(error)
  }
  <span style="color:#408080;font-style:italic">// 显示提示
</span><span style="color:#408080;font-style:italic"></span>  Message({
    message<span style="color:#666">:</span> error.message,
    type<span style="color:#666">:</span> <span style="color:#ba2121">&#39;error&#39;</span>,
    duration<span style="color:#666">:</span> <span style="color:#666">5</span> <span style="color:#666">*</span> <span style="color:#666">1000</span>
  })
}

<span style="color:#408080;font-style:italic">// 创建一个 axios 实例
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">const</span> service <span style="color:#666">=</span> axios.create({
  baseURL<span style="color:#666">:</span> process.env.VUE_APP_API,
  timeout<span style="color:#666">:</span> <span style="color:#666">5000</span> <span style="color:#408080;font-style:italic">// 请求超时时间
</span><span style="color:#408080;font-style:italic"></span>})

<span style="color:#408080;font-style:italic">// 请求拦截器
</span><span style="color:#408080;font-style:italic"></span>service.interceptors.request.use(
  config =&gt; {
    <span style="color:#408080;font-style:italic">// 在请求发送之前做一些处理
</span><span style="color:#408080;font-style:italic"></span>    <span style="color:#008000;font-weight:bold">const</span> token <span style="color:#666">=</span> util.cookies.get(<span style="color:#ba2121">&#39;token&#39;</span>)
    <span style="color:#408080;font-style:italic">// 让每个请求携带token-- [&#39;X-Token&#39;]为自定义key 请根据实际情况自行修改
</span><span style="color:#408080;font-style:italic"></span>    config.headers[<span style="color:#ba2121">&#39;X-Token&#39;</span>] <span style="color:#666">=</span> token
    <span style="color:#008000;font-weight:bold">return</span> config
  },
  error =&gt; {
    <span style="color:#408080;font-style:italic">// 发送失败
</span><span style="color:#408080;font-style:italic"></span>    console.log(error)
    <span style="color:#008000;font-weight:bold">return</span> <span style="color:#008000">Promise</span>.reject(error)
  }
)

<span style="color:#408080;font-style:italic">// 响应拦截器
</span><span style="color:#408080;font-style:italic"></span>service.interceptors.response.use(
  response =&gt; {
    <span style="color:#408080;font-style:italic">// dataAxios 是 axios 返回数据中的 data
</span><span style="color:#408080;font-style:italic"></span>    <span style="color:#008000;font-weight:bold">const</span> dataAxios <span style="color:#666">=</span> response.data
    <span style="color:#408080;font-style:italic">// 这个状态码是和后端约定的
</span><span style="color:#408080;font-style:italic"></span>    <span style="color:#408080;font-style:italic">//console.log(&#34;dataAxios: &#34;, dataAxios);
</span><span style="color:#408080;font-style:italic"></span>
    <span style="color:#008000;font-weight:bold">const</span> { code } <span style="color:#666">=</span> dataAxios
    <span style="color:#408080;font-style:italic">// 根据 code 进行判断
</span><span style="color:#408080;font-style:italic"></span>    <span style="color:#008000;font-weight:bold">if</span> (code <span style="color:#666">===</span> <span style="color:#008000;font-weight:bold">undefined</span>) {
      <span style="color:#408080;font-style:italic">// 如果没有 code 代表这不是项目后端开发的接口 比如可能是 D2Admin 请求最新版本
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">return</span> dataAxios
    } <span style="color:#008000;font-weight:bold">else</span> {
      <span style="color:#408080;font-style:italic">// 有 code 代表这是一个后端接口 可以进行进一步的判断
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">const</span> result <span style="color:#666">=</span> dataAxios
      <span style="color:#008000;font-weight:bold">switch</span> (code) {
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#ba2121">&#39;server-api-ok&#39;</span><span style="color:#666">:</span>
          <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#ba2121">&#39;server-api-error&#39;</span><span style="color:#666">:</span>
          errorCreate(<span style="color:#ba2121">`[ code: server-api-error ] </span><span style="color:#b68;font-weight:bold">${</span>result.error.msg<span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">: </span><span style="color:#b68;font-weight:bold">${</span>response.config.url<span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">`</span>)
          <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#ba2121">&#39;server-api-expired&#39;</span><span style="color:#666">:</span>
          errorCreate(<span style="color:#ba2121">`[ code: server-api-expired ] </span><span style="color:#b68;font-weight:bold">${</span>result.response.data.api_name<span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">: </span><span style="color:#b68;font-weight:bold">${</span>response.config.url<span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">`</span>)
          <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">default</span><span style="color:#666">:</span>
          <span style="color:#408080;font-style:italic">// 不是正确的 code
</span><span style="color:#408080;font-style:italic"></span>          errorCreate(<span style="color:#ba2121">`</span><span style="color:#b68;font-weight:bold">${</span>dataAxios.code<span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">: </span><span style="color:#b68;font-weight:bold">${</span>response.config.url<span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">`</span>)
          <span style="color:#008000;font-weight:bold">break</span>
      }
      <span style="color:#408080;font-style:italic">// console.log(&#34;result: &#34;, result);
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">return</span> result
    }
  },
  error =&gt; {
    console.log(<span style="color:#ba2121">&#39;catch error: &#39;</span>, error)

    <span style="color:#008000;font-weight:bold">if</span> (error <span style="color:#666">&amp;&amp;</span> error.response) {
      <span style="color:#008000;font-weight:bold">switch</span> (error.response.status) {
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">400</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;请求错误&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">401</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;未授权，请登录&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">403</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;拒绝访问&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">404</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">`请求地址出错: </span><span style="color:#b68;font-weight:bold">${</span>error.response.config.url<span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">`</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">408</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;请求超时&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">500</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;服务器内部错误&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">501</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;服务未实现&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">502</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;网关错误&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">503</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;服务不可用&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">504</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;网关超时&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">case</span> <span style="color:#666">505</span><span style="color:#666">:</span> error.message <span style="color:#666">=</span> <span style="color:#ba2121">&#39;HTTP版本不受支持&#39;</span>; <span style="color:#008000;font-weight:bold">break</span>
        <span style="color:#008000;font-weight:bold">default</span><span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">break</span>
      }
    }
    errorLog(error)
    <span style="color:#008000;font-weight:bold">return</span> <span style="color:#008000">Promise</span>.reject(error)
  }
)

<span style="color:#008000;font-weight:bold">export</span> <span style="color:#008000;font-weight:bold">default</span> service

</code></pre></div><blockquote>
<p>定义前端数据库（Mock）</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/mock/demo/product.js
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">const</span> Mock <span style="color:#666">=</span> require(<span style="color:#ba2121">&#39;mockjs&#39;</span>)
<span style="color:#008000;font-weight:bold">const</span> Random <span style="color:#666">=</span> Mock.Random
<span style="color:#008000;font-weight:bold">import</span> Results from <span style="color:#ba2121">&#39;../result&#39;</span>

<span style="color:#008000;font-weight:bold">const</span> titleList <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;男士上衣&#39;</span>, <span style="color:#ba2121">&#39;T恤&#39;</span>, <span style="color:#ba2121">&#39;衬衫&#39;</span>, <span style="color:#ba2121">&#39;牛仔裤&#39;</span>, <span style="color:#ba2121">&#39;皮衣&#39;</span>, <span style="color:#ba2121">&#39;短裙&#39;</span>];

<span style="color:#408080;font-style:italic">// 定义数据表
</span><span style="color:#408080;font-style:italic">// ----------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">var</span> table_products <span style="color:#666">=</span> [];


<span style="color:#408080;font-style:italic">// 定义数据表结构
</span><span style="color:#408080;font-style:italic">// ----------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">const</span> init_table <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">function</span>() {
  table_products <span style="color:#666">=</span> [];

  <span style="color:#008000;font-weight:bold">for</span> (<span style="color:#008000;font-weight:bold">let</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> <span style="color:#666">10</span>; i<span style="color:#666">++</span>) {
    <span style="color:#008000;font-weight:bold">let</span> product <span style="color:#666">=</span> {
      id<span style="color:#666">:</span> i <span style="color:#666">+</span> <span style="color:#666">1</span>,
      title<span style="color:#666">:</span> titleList[<span style="color:#008000">Math</span>.floor(<span style="color:#008000">Math</span>.random()<span style="color:#666">*</span>titleList.length)],
      price<span style="color:#666">:</span> Random.<span style="color:#008000;font-weight:bold">float</span>(<span style="color:#666">10</span>, <span style="color:#666">100</span>).toFixed(<span style="color:#666">2</span>),
      stock<span style="color:#666">:</span> Random.integer(<span style="color:#666">10</span>, <span style="color:#666">100</span>),
      saleCount<span style="color:#666">:</span> Random.integer(<span style="color:#666">0</span>, <span style="color:#666">90</span>),
      isSale<span style="color:#666">:</span> Random.integer(<span style="color:#666">0</span>, <span style="color:#666">1</span>),
      createTime<span style="color:#666">:</span> Random.datetime(),
      imgUrl<span style="color:#666">:</span> Random.dataImage(<span style="color:#ba2121">&#39;60x60&#39;</span>, <span style="color:#ba2121">&#39;ZAdmin-&#39;</span> <span style="color:#666">+</span> (i <span style="color:#666">+</span> <span style="color:#666">1</span>)),
    }
    table_products.push(product)
  }
}


<span style="color:#408080;font-style:italic">// 定义 CRUD 接口
</span><span style="color:#408080;font-style:italic">// ----------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">const</span> get_all_products <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">function</span> () {
  <span style="color:#008000;font-weight:bold">let</span> data <span style="color:#666">=</span> {products<span style="color:#666">:</span> table_products}
  <span style="color:#008000;font-weight:bold">return</span> Results.Ok(data)
}


<span style="color:#408080;font-style:italic">// 定义 API
</span><span style="color:#408080;font-style:italic">// ----------------------
</span><span style="color:#408080;font-style:italic"></span>
init_table()
Mock.mock(<span style="color:#ba2121">&#39;/demo/product/get_all_products&#39;</span>, <span style="color:#ba2121">&#39;get&#39;</span>, get_all_products);
</code></pre></div><blockquote>
<p>定义 API 接口（API）</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/api/demo/product.js
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">import</span> request from <span style="color:#ba2121">&#39;@/plugin/axios&#39;</span>


<span style="color:#408080;font-style:italic">// 定义 API 调用
</span><span style="color:#408080;font-style:italic">// --------------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">export</span> <span style="color:#008000;font-weight:bold">default</span> {

  get_all_products<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">function</span>() {
    <span style="color:#008000;font-weight:bold">return</span> request({
      url<span style="color:#666">:</span> <span style="color:#ba2121">&#39;demo/product/get_all_products&#39;</span>,
      method<span style="color:#666">:</span> <span style="color:#ba2121">&#39;get&#39;</span>,
      data<span style="color:#666">:</span> {}
    })
  },

}

</code></pre></div><blockquote>
<p>定义数据缓存（Vuex）</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/store/modules/demo/modules/product.js
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">import</span> ProductService from <span style="color:#ba2121">&#39;@/api/demo/product&#39;</span>

<span style="color:#408080;font-style:italic">// 定义缓存
</span><span style="color:#408080;font-style:italic">// ------------------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">export</span> <span style="color:#008000;font-weight:bold">default</span> {
  namespaced<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span>,

  <span style="color:#408080;font-style:italic">// 缓存数据
</span><span style="color:#408080;font-style:italic"></span>  state<span style="color:#666">:</span> {
    products<span style="color:#666">:</span> [],
  },

  getters<span style="color:#666">:</span> {
    products<span style="color:#666">:</span> (state) =&gt; { <span style="color:#008000;font-weight:bold">return</span> state.products },
  },

  mutations<span style="color:#666">:</span> {
   get_all_products(state, data) {
      <span style="color:#408080;font-style:italic">//console.log(&#34;in store.mutations.get_all_products.&#34;)
</span><span style="color:#408080;font-style:italic"></span>     state.products <span style="color:#666">=</span> data
    }
  },

  <span style="color:#408080;font-style:italic">// 缓存 CRUD 异步接口
</span><span style="color:#408080;font-style:italic"></span>  actions<span style="color:#666">:</span> {
    <span style="color:#008000;font-weight:bold">async</span> get_all_products ({ commit }) {
      <span style="color:#408080;font-style:italic">//console.log(&#34;in store.actions.get_all_products.&#34;)
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">let</span> rs <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">await</span> ProductService.get_all_products()
      <span style="color:#008000;font-weight:bold">if</span> (rs.success <span style="color:#666">===</span> <span style="color:#008000;font-weight:bold">false</span>) {
        <span style="color:#008000;font-weight:bold">return</span> rs
      }

      commit(<span style="color:#ba2121">&#39;get_all_products&#39;</span>, rs.response.data.products)
      <span style="color:#008000;font-weight:bold">return</span> rs

    },
  },
}
</code></pre></div><blockquote>
<p>页面调用（Page）</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/views/demo/page13/index.vue
</span><span style="color:#408080;font-style:italic"></span>
<span style="color:#666">&lt;</span>template<span style="color:#666">&gt;</span>
  <span style="color:#666">&lt;</span>d2<span style="color:#666">-</span>container type<span style="color:#666">=</span><span style="color:#ba2121">&#34;full&#34;</span> <span style="color:#008000;font-weight:bold">class</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;overflow-y-scroll&#34;</span><span style="color:#666">&gt;</span>
    <span style="color:#666">&lt;</span>div <span style="color:#008000;font-weight:bold">class</span><span style="color:#666">=</span><span style="color:#ba2121">&#34;container mx-auto mt-4 mb-4&#34;</span><span style="color:#666">&gt;</span>
      <span style="color:#666">&lt;</span>el<span style="color:#666">-</span>card<span style="color:#666">&gt;</span>
        <span style="color:#666">&lt;</span>d2<span style="color:#666">-</span>crud
          ref<span style="color:#666">=</span><span style="color:#ba2121">&#34;d2Crud&#34;</span>
          <span style="color:#666">:</span>columns<span style="color:#666">=</span><span style="color:#ba2121">&#34;columns&#34;</span>
          <span style="color:#666">:</span>data<span style="color:#666">=</span><span style="color:#ba2121">&#34;products&#34;</span>
        <span style="color:#666">&gt;</span>
        <span style="color:#666">&lt;</span><span style="">/d2-crud&gt;</span>
      <span style="color:#666">&lt;</span><span style="">/el-card&gt;</span>
    <span style="color:#666">&lt;</span><span style="">/div&gt;</span>
  <span style="color:#666">&lt;</span><span style="">/d2-container&gt;</span>
<span style="color:#666">&lt;</span><span style="">/template&gt;</span>

<span style="color:#666">&lt;</span>script<span style="color:#666">&gt;</span>
<span style="color:#008000;font-weight:bold">import</span> { mapGetters } from <span style="color:#ba2121">&#39;vuex&#39;</span>

<span style="color:#008000;font-weight:bold">export</span> <span style="color:#008000;font-weight:bold">default</span> {
  name<span style="color:#666">:</span> <span style="color:#ba2121">&#39;page11&#39;</span>,
  data<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">function</span> () {
    <span style="color:#008000;font-weight:bold">return</span> {
      columns<span style="color:#666">:</span> [
        { title<span style="color:#666">:</span> <span style="color:#ba2121">&#39;ID&#39;</span>, key<span style="color:#666">:</span> <span style="color:#ba2121">&#39;id&#39;</span>, width<span style="color:#666">:</span> <span style="color:#ba2121">&#39;40&#39;</span>},
        { title<span style="color:#666">:</span> <span style="color:#ba2121">&#39;名称&#39;</span>, key<span style="color:#666">:</span> <span style="color:#ba2121">&#39;title&#39;</span> },
        { title<span style="color:#666">:</span> <span style="color:#ba2121">&#39;价格&#39;</span>, key<span style="color:#666">:</span> <span style="color:#ba2121">&#39;price&#39;</span>, width<span style="color:#666">:</span> <span style="color:#ba2121">&#39;80&#39;</span>},
        { title<span style="color:#666">:</span> <span style="color:#ba2121">&#39;库存&#39;</span>, key<span style="color:#666">:</span> <span style="color:#ba2121">&#39;stock&#39;</span>, width<span style="color:#666">:</span> <span style="color:#ba2121">&#39;80&#39;</span>},
        { title<span style="color:#666">:</span> <span style="color:#ba2121">&#39;销量&#39;</span>, key<span style="color:#666">:</span> <span style="color:#ba2121">&#39;saleCount&#39;</span>, width<span style="color:#666">:</span> <span style="color:#ba2121">&#39;80&#39;</span>},
      ],
    }
  },
  computed<span style="color:#666">:</span> {
    ...mapGetters(<span style="color:#ba2121">&#39;demo/product&#39;</span>, [<span style="color:#ba2121">&#39;products&#39;</span>])
  },

  methods<span style="color:#666">:</span> {
    <span style="color:#008000;font-weight:bold">async</span> get_all_products() {
      <span style="color:#008000;font-weight:bold">await</span> <span style="color:#008000;font-weight:bold">this</span>.$store.dispatch(<span style="color:#ba2121">&#34;demo/product/get_all_products&#34;</span>);
    }
  },

  <span style="color:#008000;font-weight:bold">async</span> mounted () {
    <span style="color:#008000;font-weight:bold">await</span> <span style="color:#008000;font-weight:bold">this</span>.get_all_products();
  }
}
<span style="color:#666">&lt;</span><span style="">/script&gt;</span>
</code></pre></div><blockquote>
<p>引入 MOCK 数据</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// main.js
</span><span style="color:#408080;font-style:italic"></span>
<span style="color:#408080;font-style:italic">// 引入mock数据
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">import</span> mock_data from <span style="color:#ba2121">&#39;@/mock&#39;</span>
</code></pre></div><blockquote>
<p>测试：实现Page-Vuex-API-Mock(server) 的调用</p>
</blockquote>
<p><img src="image-20210724141900449.png" alt="image-20210724141900449"></p>
<h2 id="八认证管理">八，认证管理</h2>
<blockquote>
<p>Mock</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/mock/demo/user.js
</span><span style="color:#408080;font-style:italic"></span>
<span style="color:#008000;font-weight:bold">const</span> Mock <span style="color:#666">=</span> require(<span style="color:#ba2121">&#39;mockjs&#39;</span>)
<span style="color:#008000;font-weight:bold">import</span> Results from <span style="color:#ba2121">&#39;../result&#39;</span>

<span style="color:#408080;font-style:italic">// 定义数据表
</span><span style="color:#408080;font-style:italic">// ----------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">var</span> table_users <span style="color:#666">=</span> []


<span style="color:#408080;font-style:italic">// 定义数据表结构
</span><span style="color:#408080;font-style:italic">// ----------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">const</span> init_table <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">function</span>() {
  table_users <span style="color:#666">=</span> [
    { user_name<span style="color:#666">:</span> <span style="color:#ba2121">&#39;admin&#39;</span>, password<span style="color:#666">:</span> <span style="color:#ba2121">&#39;admin&#39;</span>, uuid<span style="color:#666">:</span> <span style="color:#ba2121">&#39;admin-uuid&#39;</span>, role<span style="color:#666">:</span> <span style="color:#ba2121">&#39;admin&#39;</span>, token<span style="color:#666">:</span> <span style="color:#ba2121">&#39;admin-uuid&#39;</span>, is_login<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">false</span> },
    { user_name<span style="color:#666">:</span> <span style="color:#ba2121">&#39;editor&#39;</span>, password<span style="color:#666">:</span> <span style="color:#ba2121">&#39;editor&#39;</span>, uuid<span style="color:#666">:</span> <span style="color:#ba2121">&#39;editor-uuid&#39;</span>, role<span style="color:#666">:</span> <span style="color:#ba2121">&#39;editor&#39;</span>, token<span style="color:#666">:</span> <span style="color:#ba2121">&#39;editor-uuid&#39;</span>, is_login<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">false</span>},
    { user_name<span style="color:#666">:</span> <span style="color:#ba2121">&#39;user1&#39;</span>, password<span style="color:#666">:</span> <span style="color:#ba2121">&#39;user1&#39;</span>, uuid<span style="color:#666">:</span> <span style="color:#ba2121">&#39;user1-uuid&#39;</span>,  role<span style="color:#666">:</span> <span style="color:#ba2121">&#39;user&#39;</span>, token<span style="color:#666">:</span> <span style="color:#ba2121">&#39;user1-uuid&#39;</span>, is_login<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">false</span> }
  ];
}


<span style="color:#408080;font-style:italic">// 定义 CRUD 接口
</span><span style="color:#408080;font-style:italic">// ----------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">const</span> get_all_users <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">function</span> (request) {
  <span style="color:#008000;font-weight:bold">const</span> params <span style="color:#666">=</span> JSON.parse(request.body)

  <span style="color:#008000;font-weight:bold">if</span> (<span style="color:#666">!</span>params.user_token) {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;no user_token&#39;</span>)
  }

  <span style="color:#008000;font-weight:bold">const</span> user <span style="color:#666">=</span> table_users.find(e =&gt; e.token <span style="color:#666">===</span> params.user_token)
  <span style="color:#008000;font-weight:bold">if</span> (<span style="color:#666">!</span>user) {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;user_token is fault.&#39;</span>)
  }

  <span style="color:#008000;font-weight:bold">return</span> Results.Ok({users<span style="color:#666">:</span> table_users } )

}

<span style="color:#008000;font-weight:bold">const</span> get_user_info <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">function</span>(request) {
  <span style="color:#008000;font-weight:bold">const</span> params <span style="color:#666">=</span> JSON.parse(request.body)

  <span style="color:#008000;font-weight:bold">if</span> (<span style="color:#666">!</span>params.user_token) {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;no user_token&#39;</span>)
  }

  <span style="color:#008000;font-weight:bold">if</span> (<span style="color:#666">!</span>params.user_uuid) {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;no user_uuid&#39;</span>)
  }

  <span style="color:#008000;font-weight:bold">const</span> user <span style="color:#666">=</span> table_users.find(e =&gt; e.uuid <span style="color:#666">===</span> params.user_uuid)
  <span style="color:#008000;font-weight:bold">if</span> (user) {
    <span style="color:#008000;font-weight:bold">if</span> (user.user_token <span style="color:#666">===</span> params.user_token) {
      <span style="color:#008000;font-weight:bold">return</span> Results.Ok(
        {
          user<span style="color:#666">:</span> {
            user_name<span style="color:#666">:</span> user.user_name,
            user_uuid<span style="color:#666">:</span> user.uuid,
            user_role<span style="color:#666">:</span> user.role,
            user_is_login<span style="color:#666">:</span> user.is_login,
          }})
    } <span style="color:#008000;font-weight:bold">else</span> {
      <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#34;user_token is fault.&#34;</span>)
    }

  } <span style="color:#008000;font-weight:bold">else</span> {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#34;user_uuid is fault.&#34;</span>)
  }
}

<span style="color:#008000;font-weight:bold">const</span> login <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">function</span>(request) {

  <span style="color:#008000;font-weight:bold">const</span> params <span style="color:#666">=</span> JSON.parse(request.body)
  <span style="color:#008000;font-weight:bold">if</span> (<span style="color:#666">!</span>params.user_name) {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;no user_name&#39;</span>)
  }
  <span style="color:#008000;font-weight:bold">if</span> (<span style="color:#666">!</span>params.user_password) {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;no user_password&#39;</span>)
  }

  <span style="color:#008000;font-weight:bold">const</span> user <span style="color:#666">=</span> table_users.find(e =&gt; e.user_name <span style="color:#666">===</span> params.user_name <span style="color:#666">&amp;&amp;</span> e.password <span style="color:#666">===</span> params.user_password)

  <span style="color:#008000;font-weight:bold">if</span> (user) {
    user.is_login <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">true</span>
    <span style="color:#008000;font-weight:bold">return</span> Results.Ok({
      user<span style="color:#666">:</span> {
        user_name<span style="color:#666">:</span> user.user_name,
        user_uuid<span style="color:#666">:</span> user.uuid,
        user_role<span style="color:#666">:</span> user.role,
        user_token<span style="color:#666">:</span> user.token,
        user_is_login<span style="color:#666">:</span> user.is_login,
      }
    })

  } <span style="color:#008000;font-weight:bold">else</span> {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;user_name or user_password is error.&#39;</span>)
  }
}


<span style="color:#008000;font-weight:bold">const</span> logout <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">function</span>(request) {
  <span style="color:#008000;font-weight:bold">const</span> params <span style="color:#666">=</span> JSON.parse(request.body)
  <span style="color:#008000;font-weight:bold">if</span> (<span style="color:#666">!</span>params.user_uuid) {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;no user_uuid&#39;</span>)
  }

  <span style="color:#008000;font-weight:bold">if</span> (<span style="color:#666">!</span>params.user_token) {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;no user_token&#39;</span>)
  }

  <span style="color:#008000;font-weight:bold">const</span> user <span style="color:#666">=</span> table_users.find(e =&gt; e.uuid <span style="color:#666">===</span> params.user_uuid <span style="color:#666">&amp;&amp;</span> e.token <span style="color:#666">===</span> params.user_token)

  <span style="color:#008000;font-weight:bold">if</span> (user) {
    user.is_login <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">false</span>
    <span style="color:#008000;font-weight:bold">return</span> Results.Ok(
      {user<span style="color:#666">:</span> {
          user_name<span style="color:#666">:</span> user.user_name,
          user_uuid<span style="color:#666">:</span> user.uuid,
          user_role<span style="color:#666">:</span> user.role,
          user_is_login<span style="color:#666">:</span> user.is_login,
        }})
  } <span style="color:#008000;font-weight:bold">else</span> {
    <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>(<span style="color:#ba2121">&#39;user_uuid or user_token is error.&#39;</span>)
  }
}

<span style="color:#408080;font-style:italic">// 定义 API
</span><span style="color:#408080;font-style:italic">// ----------------------
</span><span style="color:#408080;font-style:italic"></span>init_table()

Mock.mock(<span style="color:#ba2121">&#39;/demo/user/get_all_users&#39;</span>, <span style="color:#ba2121">&#39;get&#39;</span>, get_all_users);
Mock.mock(<span style="color:#ba2121">&#39;/demo/user/get_user_info&#39;</span>, <span style="color:#ba2121">&#39;post&#39;</span>, get_user_info);
Mock.mock(<span style="color:#ba2121">&#39;/demo/user/login&#39;</span>, <span style="color:#ba2121">&#39;post&#39;</span>, login);
Mock.mock(<span style="color:#ba2121">&#39;/demo/user/logout&#39;</span>, <span style="color:#ba2121">&#39;post&#39;</span>, logout);
</code></pre></div><blockquote>
<p>API</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/api/demo/user.js
</span><span style="color:#408080;font-style:italic"></span>
<span style="color:#008000;font-weight:bold">import</span> request from <span style="color:#ba2121">&#39;@/plugin/axios&#39;</span>


<span style="color:#408080;font-style:italic">// 定义 API 调用
</span><span style="color:#408080;font-style:italic">// --------------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">export</span> <span style="color:#008000;font-weight:bold">default</span> {

  get_all_users<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">function</span>(data) {
    <span style="color:#008000;font-weight:bold">return</span> request({
      url<span style="color:#666">:</span> <span style="color:#ba2121">&#39;demo/user/get_all_users&#39;</span>,
      method<span style="color:#666">:</span> <span style="color:#ba2121">&#39;get&#39;</span>,
      data<span style="color:#666">:</span> data
    })
  },

  get_user_info<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">function</span>(data) {
    <span style="color:#008000;font-weight:bold">return</span> request({
      url<span style="color:#666">:</span> <span style="color:#ba2121">&#39;demo/user/get_user_info&#39;</span>,
      method<span style="color:#666">:</span> <span style="color:#ba2121">&#39;post&#39;</span>,
      data<span style="color:#666">:</span> data
    })
  },

  login<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">function</span>(data) {
    <span style="color:#008000;font-weight:bold">return</span> request({
      url<span style="color:#666">:</span> <span style="color:#ba2121">&#39;demo/user/login&#39;</span>,
      method<span style="color:#666">:</span> <span style="color:#ba2121">&#39;post&#39;</span>,
      data<span style="color:#666">:</span> data
    })
  },

  logout<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">function</span>(data) {
    <span style="color:#008000;font-weight:bold">return</span> request({
      url<span style="color:#666">:</span> <span style="color:#ba2121">&#39;demo/user/logout&#39;</span>,
      method<span style="color:#666">:</span> <span style="color:#ba2121">&#39;post&#39;</span>,
      data<span style="color:#666">:</span> data
    })
  },

}
</code></pre></div><blockquote>
<p>Vuex</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/store/modules/demo/modules/user.js
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">import</span> { Message, MessageBox } from <span style="color:#ba2121">&#39;element-ui&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> util from <span style="color:#ba2121">&#39;@/libs/util.js&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> router from <span style="color:#ba2121">&#39;@/router&#39;</span>
<span style="color:#008000;font-weight:bold">import</span> Results from <span style="color:#ba2121">&#39;@/data/demo/result&#39;</span>

<span style="color:#008000;font-weight:bold">import</span> UserService from <span style="color:#ba2121">&#39;@/api/demo/user&#39;</span>

<span style="color:#408080;font-style:italic">// 定义缓存
</span><span style="color:#408080;font-style:italic">// ------------------------------
</span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">export</span> <span style="color:#008000;font-weight:bold">default</span> {
  namespaced<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span>,

  <span style="color:#408080;font-style:italic">// 缓存数据
</span><span style="color:#408080;font-style:italic"></span>  state<span style="color:#666">:</span> {
    users<span style="color:#666">:</span> [],
  },

  getters<span style="color:#666">:</span> {
    users<span style="color:#666">:</span> (state) =&gt; { <span style="color:#008000;font-weight:bold">return</span> state.users }
  },

  mutations<span style="color:#666">:</span> {
    get_all_users(state, data) {
      state.users <span style="color:#666">=</span> data
    }
  },

  <span style="color:#408080;font-style:italic">// 缓存 CRUD 异步接口
</span><span style="color:#408080;font-style:italic"></span>  actions<span style="color:#666">:</span> {
    <span style="color:#008000;font-weight:bold">async</span> get_all_users ({ commit }) {
      <span style="color:#408080;font-style:italic">//console.log(&#34;in store.actions.get_all_products.&#34;)
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">let</span> rs <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">await</span> UserService.get_all_users()
      <span style="color:#008000;font-weight:bold">if</span> (rs.success <span style="color:#666">===</span> <span style="color:#008000;font-weight:bold">false</span>) {
        <span style="color:#008000;font-weight:bold">return</span> rs
      }
      commit(<span style="color:#ba2121">&#39;get_all_users&#39;</span>, rs.response.data.users)
    },

    <span style="color:#008000;font-weight:bold">async</span> login({ dispatch }, {user_name <span style="color:#666">=</span> <span style="color:#ba2121">&#39;&#39;</span>, user_password <span style="color:#666">=</span> <span style="color:#ba2121">&#39;&#39;</span>} <span style="color:#666">=</span> {}) {

      <span style="color:#008000;font-weight:bold">let</span> rs <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">await</span> UserService.login({user_name, user_password})
      <span style="color:#008000;font-weight:bold">if</span> (rs.success <span style="color:#666">===</span> <span style="color:#008000;font-weight:bold">false</span>) {
        <span style="color:#008000;font-weight:bold">return</span> Results.<span style="color:#008000">Error</span>()
      }
      util.cookies.set(<span style="color:#ba2121">&#39;uuid&#39;</span>, rs.response.data.user.user_uuid)
      util.cookies.set(<span style="color:#ba2121">&#39;token&#39;</span>, rs.response.data.user.user_token)

      <span style="color:#008000;font-weight:bold">let</span> user_info <span style="color:#666">=</span> rs.response.data.user
      sessionStorage.setItem(<span style="color:#ba2121">&#34;user_info&#34;</span>, JSON.stringify(user_info))
      <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;d2admin/user/set&#39;</span>, { user_name<span style="color:#666">:</span> rs.response.data.user.user_name, user_uuid<span style="color:#666">:</span> rs.response.data.user.user_uuid }, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
      <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;load&#39;</span>)
      <span style="color:#008000;font-weight:bold">return</span> Results.Ok(rs.response.data)
    },

    <span style="color:#008000;font-weight:bold">async</span> logout({ commit, dispatch }, { confirm <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">false</span>} <span style="color:#666">=</span> {}) {
      <span style="color:#008000;font-weight:bold">async</span> <span style="color:#008000;font-weight:bold">function</span> logout() {
        <span style="color:#008000;font-weight:bold">let</span> user_uuid <span style="color:#666">=</span> util.cookies.get(<span style="color:#ba2121">&#34;uuid&#34;</span>)
        <span style="color:#008000;font-weight:bold">let</span> user_token <span style="color:#666">=</span> util.cookies.get(<span style="color:#ba2121">&#34;token&#34;</span>)

        util.cookies.remove(<span style="color:#ba2121">&#39;uuid&#39;</span>)
        util.cookies.remove(<span style="color:#ba2121">&#39;token&#39;</span>)
        sessionStorage.removeItem(<span style="color:#ba2121">&#34;user_info&#34;</span>)

        <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;d2admin/user/set&#39;</span>, {}, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
        <span style="color:#008000;font-weight:bold">await</span> UserService.logout({user_uuid, user_token})
        router.push({ name<span style="color:#666">:</span> <span style="color:#ba2121">&#39;login&#39;</span> })
      }
      <span style="color:#008000;font-weight:bold">if</span> (confirm) {
        commit(<span style="color:#ba2121">&#39;d2admin/gray/set&#39;</span>, <span style="color:#008000;font-weight:bold">true</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
        MessageBox.confirm(<span style="color:#ba2121">&#39;确定要注销当前用户吗&#39;</span>, <span style="color:#ba2121">&#39;注销用户&#39;</span>, { type<span style="color:#666">:</span> <span style="color:#ba2121">&#39;warning&#39;</span> })
          .then(() =&gt; {
            commit(<span style="color:#ba2121">&#39;d2admin/gray/set&#39;</span>, <span style="color:#008000;font-weight:bold">false</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
            logout()
          })
          .<span style="color:#008000;font-weight:bold">catch</span>(() =&gt; {
            commit(<span style="color:#ba2121">&#39;d2admin/gray/set&#39;</span>, <span style="color:#008000;font-weight:bold">false</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
            Message({ message<span style="color:#666">:</span> <span style="color:#ba2121">&#39;取消注销操作&#39;</span> })
          })

      }

      <span style="color:#008000;font-weight:bold">return</span> Results.Ok()
    },

    <span style="color:#008000;font-weight:bold">async</span> load ({ dispatch }) {
      <span style="color:#408080;font-style:italic">// 加载用户名
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;d2admin/user/load&#39;</span>, <span style="color:#008000;font-weight:bold">null</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
      <span style="color:#408080;font-style:italic">// 加载主题
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;d2admin/theme/load&#39;</span>, <span style="color:#008000;font-weight:bold">null</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
      <span style="color:#408080;font-style:italic">// 加载页面过渡效果设置
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;d2admin/transition/load&#39;</span>, <span style="color:#008000;font-weight:bold">null</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
      <span style="color:#408080;font-style:italic">// 持久化数据加载上次退出时的多页列表
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;d2admin/page/openedLoad&#39;</span>, <span style="color:#008000;font-weight:bold">null</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
      <span style="color:#408080;font-style:italic">// 持久化数据加载侧边栏配置
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;d2admin/menu/asideLoad&#39;</span>, <span style="color:#008000;font-weight:bold">null</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
      <span style="color:#408080;font-style:italic">// 持久化数据加载全局尺寸
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;d2admin/size/load&#39;</span>, <span style="color:#008000;font-weight:bold">null</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })
      <span style="color:#408080;font-style:italic">// 持久化数据加载颜色设置
</span><span style="color:#408080;font-style:italic"></span>      <span style="color:#008000;font-weight:bold">await</span> dispatch(<span style="color:#ba2121">&#39;d2admin/color/load&#39;</span>, <span style="color:#008000;font-weight:bold">null</span>, { root<span style="color:#666">:</span> <span style="color:#008000;font-weight:bold">true</span> })

      <span style="color:#008000;font-weight:bold">return</span> Results.Ok()
    }
  },

}
</code></pre></div><blockquote>
<p>View</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#408080;font-style:italic">// src/views/system/login/page.vue
</span><span style="color:#408080;font-style:italic">// src/layout/header-aside/components/header-user/index.vue
</span></code></pre></div><blockquote>
<p>测试</p>
</blockquote>
<p><img src="image-20210724220949475.png" alt="image-20210724220949475"></p>
<h2 id="九微服务项目结构">九，微服务项目结构</h2>
<blockquote>
<p>/src/base 是基础框架（请勿修改）</p>
<p>/src/views/microservices 下创建微服务模块：demo，项目组织结构如下：</p>
<ul>
<li>Mock（模拟后端服务）</li>
<li>API（定义API接口）</li>
<li>Store（定义前端数据缓存Vuex）</li>
<li>Page（定义前端页面）</li>
</ul>
<p>项目集成方法：</p>
<ul>
<li>将microservices目录下的微服务目录（例如demo）拷贝到主程序的microservice目录下</li>
<li>在router目录下加入路由信息</li>
<li>在menu目录下加入菜单信息</li>
</ul>
</blockquote>
<p><img src="image-20210725142121527.png" alt="image-20210725142121527"></p>
<blockquote>
<p>参考代码：https://github.com/taodanfang/d2admin-microservices-template</p>
</blockquote>
<h2 id="参考文献">参考文献</h2>
<blockquote>
<ul>
<li><a href="https://www.jianshu.com/p/79d092dd63a9">https://www.jianshu.com/p/79d092dd63a9</a></li>
<li><a href="https://v-charts.js.org/#/">https://v-charts.js.org/#/</a></li>
<li><a href="https://d2.pub/zh/">https://d2.pub/zh/</a></li>
<li><a href="https://www.tailwindcss.cn">https://www.tailwindcss.cn</a></li>
<li><a href="http://mockjs.com/examples.html">http://mockjs.com/examples.html</a></li>
</ul>
</blockquote>
        </article>
        

      </main>

      <nav class="end-nav">
        
        <a ontouchstart="cardPressed.call(this)" ontouchend="cardReleased.call(this)" ontouchmove="cardReleased.call(this)" 
  href="https://taodanfang.github.io/posts/go-kit-example-study-1/" class="card blog-card" rel="bookmark" >
  
  <div class="card-img-container">
    <p class="card-img-overlay">下一篇</p>
    <picture>
      
      
      
      <source srcset="https://taodanfang.github.io/posts/go-kit-example-study-1/4_hu3d03a01dcc18bc5be0e67db3d8d209a6_2292329_400x0_resize_lanczos_3.png 1x, https://taodanfang.github.io/posts/go-kit-example-study-1/4_hu3d03a01dcc18bc5be0e67db3d8d209a6_2292329_800x0_resize_lanczos_3.png 2x, https://taodanfang.github.io/posts/go-kit-example-study-1/4_hu3d03a01dcc18bc5be0e67db3d8d209a6_2292329_1200x0_resize_lanczos_3.png 3x">
      <img src="https://taodanfang.github.io/posts/go-kit-example-study-1/4_hu3d03a01dcc18bc5be0e67db3d8d209a6_2292329_400x0_resize_lanczos_3.png" class="card-img" >
    </picture>
  </div>
  
  <article class="card-body">
    <h2 class="card-title">Go Kit 官方示例学习及其 API Gateway 实现</h2>
    <p class="card-text">该文是Go kit 官方示例的学习笔记，并总结了结合stringsvc实现 API Gateway 的方法
</p>
    <div class="card-subtext muted-text">
      <p>Posted <time datetime="2021-07-07 77:00">Jul 7, 2021</time></p>
      <p>#golang #kit #microservice </p>
    </div>
  </article>
</a>
        
      </nav>

      
        <script src="https://utteranc.es/client.js"
        repo="taodanfang/hugoblogtalks"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
        </script>
      

  </div>

  <footer>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</footer>
  
  <script defer src="https://taodanfang.github.io/js/katex.js"></script>


  <script defer src="https://taodanfang.github.io/js/auto-render.js" onload="renderMathInElement(document.body);"></script>


<script src="https://taodanfang.github.io/js/core.min.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

  <script>
    $('#TableOfContents a').click(function () {
      console.log("click");
    var target = $(this).attr('href');
    console.log(target);
    $('html, body').animate({
       scrollTop: $(target).offset().top - 108 
     }, 500);
     return false;
    });
    $('body > div:nth-child(1) > nav > h3 > a').click(function () {
      console.log("click");
    var target = $(this).attr('href');
    console.log(target);
    $('html, body').animate({
       scrollTop: $(target).offset().top - 108 
     }, 500);
     return false;
    });
  </script>
  </body>
</html>
